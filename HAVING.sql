SELECT  CITY,SUM(TOTALPRICE) AS TOTALPRICE
,COUNT(DISTINCT CUSTOMERNAME) CUSTOMERCOUNT

FROM SALES

GROUP BY CITY 
HAVING SUM(TOTALPRICE)>40000

ORDER BY SUM(TOTALPRICE) DESC